
{% extends 'base.html' %}
{% load static %}
{% block title %}All Products {% endblock %}
{% block content %}

    
		<!-- product section -->
		<div class="container-fluid py-5">
			<div class="row">
				<div class="col-md-2 d-none d-md-block">
					<div class="filter-section">
						<h2>Filters</h2>
						<div class="filter-title">Price</div>
						<div class="filter-options">
							{% for key, value in price_range_counts.items %}
							<div class="d-flex justify-content-between align-items-center">
								<label><input type="checkbox" />
									<a href="{% url 'price_range_products' value.slug %}" class="text-decoration-none text-black">	
										{{ value.label}} 
									</a></label>
								<span>({{ value.count }})</span>
							</div>
							{% endfor %}
							
						</div>
					</div>
				
					<div class="filter-section">
						<div class="filter-title">Category</div>
						
						
						<div class="filter-options">
							{% for category, slug, count in category_data %}
							<div class="d-flex justify-content-between align-items-center">
								<label><input type="checkbox" />
									{% if category == "All Products" %}
										<a href="{% url 'all_products' %}" class="text-decoration-none text-black">
											{{ category }}
										</a>
									{% else %}
										{% if slug %}
											<a href="{% url 'category_products' slug %}" class="text-decoration-none text-black">
												{{ category }}
											</a>
										{% else %}
											{{ category }}
										{% endif %}
									{% endif %}
								</label>
								<span>({{ count	}})</span>
							</div>
							{% endfor %}
							
						</div>
					</div>
				
					<div class="filter-section">
						<div class="filter-title">Rating</div>
						<div class="filter-options">
							{% for rating, count in rating_counts.items %}
								<div class="d-flex justify-content-between align-items-center">
									<label><input type="checkbox" />
										<a href="{% url 'rating_products' rating %}" class="text-decoration-none text-black" style="color:gold !important">
											{% for i in "12345"|slice:":5" %}
												{% if forloop.counter <= rating %}
													★
												{% else %}
													☆
												{% endif %}
											{% endfor %}
										</a>
									
									
									</label>
									<span>( {{ count }})</span>
								</div>
							{% endfor %}
							
						</div>
					</div>
				
					<div class="filter-section">
						<div class="filter-title">Discount</div>
						<div class="filter-options">
							{% for key, value in discount_counts.items %}
								<div class="d-flex justify-content-between align-items-center">
									<label>
										<input type="checkbox" />
										<a href="{% url 'discount_products' value.slug %}" class="text-decoration-none text-black">	
											{{ value.label }}
										</a>
									</label>
									<span>({{ value.count }})</span>
								</div>
							{% endfor %}
							
						</div>
					</div>
				
					<div class="filter-section">
						<div class="filter-title">Color</div>
						<div class="filter-options">
							{% for color, count in color_counts.items %}
								<div class="d-flex justify-content-between align-items-center">
									
										<label>
											<a href="{% url 'color_products' color %}" class="text-decoration-none text-black">	
												<input type="checkbox" /> {{ color }}</label>
											</a>
										<span>({{ count }})</span>
									
								</div>
							{% endfor %}
							
						</div>
					</div>
				</div>

				<div class="col-md-10">
					<button
						class="btn btn-primary d-md-none mb-3"
						type="button"
						data-bs-toggle="offcanvas"
						data-bs-target="#filterOffcanvas"
						aria-controls="filterOffcanvas"
					>
						<i class="fas fa-filter"></i> Filters
					</button>

					<h2>Products</h2> 
					
					<div class="row">
						<div class="col-sm-12 col-md-12 col-lg-12">
							<div class="container-fluid pb-5">
								
								<div
									class="row row-cols-2 row-cols-md-2 row-cols-lg-3 row-cols-xl-3 g-4 justify-content-center"
									id="filter-cards"
								>
                                {% for product in products %}
                                    <div class="col col-sm-6 col-md-4 col-lg-4  col-xl-4">
                                        <div class="card h-100">
                                            {# … inside your {% for product in products %} loop, within <div class="card h-100"> … #}
											<div class="image-wrapper position-relative overflow-hidden" style="height: 500px;">
												<a href="{% url 'product_detail' product.slug %}">
													{# First (default) image #}
													<img 
														id="product-image-{{ forloop.counter }}" 
														class="card-img-top main-image" 
														src="{{ product.images.first.image_path.url }}" 
														alt="{{ product.name }}" 
														style="height: 100%; object-fit: cover;"
													>

													{# Second (hover) image, only output if there is a second image in the queryset #}
													{% if product.images.all|length > 1 %}
														<img 
															class="card-img-top hover-image" 
															src="{{ product.images.all.1.image_path.url }}" 
															alt="{{ product.name }} (hover)" 
															style="height: 100%; object-fit: cover;"
														>
													{% endif %}
												</a>
											</div>
											{# … the rest of your .card-body/.card-footer … #}

											

											{% if product.is_best_selling %}
												<span class="rotated-badge yellow_badge overflow-hidden">Best Selling</span>
											{% elif product.is_new_arrival %}
												<span class="rotated-badge tomato_badge overflow-hidden">New Arrival</span>
											{% endif %}
                                            <div class="card-body">
                                                {% if product.slug %}
                                                    <a href="{% url 'product_detail' product.slug %}">
                                                        <h5 class="card-title">{{ product.name }}</h5>
                                                    </a>
                                                {% else %}
                                                    <h5 class="card-title">{{ product.name }}</h5>
                                                {% endif %}
                                                <p class="card-text text-muted mb-1">Brand A</p>
                                                <p class="card-text mb-2">
                                                    ${{ product.actual_price | floatformat:0 }}
													{% if product.discount_percentage %}
														<span class="text-decoration-line-through text-danger ms-2"> ${{ product.price | floatformat:0 }}</span>
													{% endif %}
                                                    
                                                </p>

												<div class="mb-2">
													<div class="d-flex mt-1">
														
														 {% for color in product.color_sizes.all %}
															<span class="color-option rounded-circle me-2"
																style="width: 20px; height: 20px; background-color:red;"
																data-img="{{ color.image_path.url }}"
																onclick="changeImage('product-image-{{ forloop.parentloop.counter }}', this)">
																
															</span>
														{% endfor %}
														
													</div>
												</div>



                                                <p class="card-text small">
                                                    {{ product.description |truncatechars:100 }}
                                                </p>
                                                <p class="card-text text-warning mb-0">
                                                   
                                                
                                                        {% for i in "12345" %}
                                                            {% if forloop.counter <= product.full_star %}
                                                                <i class="bi bi-star-fill"></i>
                                                            {% elif product.half_star == 1 and forloop.counter == product.full_star|add:"1" %}
                                                                <i class="bi bi-star-half"></i>
                                                            {% else %}
                                                                <i class="bi bi-star"></i>
                                                            {% endif %}
                                                        {% endfor %}
                                                        
                                                    {{ product.rating }}
                                                </p>
                                                <p class="card-text small mt-2 text-success">In Stock</p>
                                            </div>
                                            <div
                                                class="card-footer d-flex justify-content-between align-items-center"
                                            >
                                                <a href="{% url 'add_cart' product.slug %}" >
                                                    <button class="btn btn-primary btn-sm" >
                                                        <i class="fas fa-cart-plus banner_button_icon"></i> Add to Cart
                                                    </button>
                                                </a>
                                                 <a href="{% url 'product_wishlist' product.slug %}" ></a>
                                                    <button class="btn btn-outline-secondary btn-sm">
                                                        <i class="bi bi-heart-fill"></i> Wishlist
                                                    </button>
                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                {% endfor %}

								
								</div>
							</div>
					</div>
				</div>
			</div>
		</div>
        
		<div
			class="offcanvas offcanvas-start"
			tabindex="-1"
			id="filterOffcanvas"
			aria-labelledby="filterOffcanvasLabel"
		>
			<div class="offcanvas-header">
				<h5 class="offcanvas-title" id="filterOffcanvasLabel">Filters</h5>
				<button
					type="button"
					class="btn-close text-reset"
					data-bs-dismiss="offcanvas"
					aria-label="Close"
				></button>
			</div>
			<div class="offcanvas-body">
				<div class="filter-section">
					<div class="filter-title">Price</div>
					<div class="filter-options">
						<label><input type="checkbox" /> $0 - $50</label>
						<label><input type="checkbox" /> $50 - $100</label>
						<label><input type="checkbox" /> $100+</label>
					</div>
				</div>
				<div class="filter-section">
					<div class="filter-title">Color</div>
					<div class="filter-options">
						<label><input type="checkbox" /> Red</label>
						<label><input type="checkbox" /> Blue</label>
						<label><input type="checkbox" /> Green</label>
					</div>
				</div>
				<div class="filter-section">
					<div class="filter-title">Size</div>
					<div class="filter-options">
						<label><input type="checkbox" /> S</label>
						<label><input type="checkbox" /> M</label>
						<label><input type="checkbox" /> L</label>
					</div>
				</div>
				<div class="filter-section">
					<div class="filter-title">Brand</div>
					<div class="filter-options">
						<label><input type="checkbox" /> Brand A</label>
						<label><input type="checkbox" /> Brand B</label>
						<label><input type="checkbox" /> Brand C</label>
					</div>
				</div>
				<button class="btn btn-primary w-100">Apply Filters</button>
			</div>
		</div>
		

{% endblock %}
